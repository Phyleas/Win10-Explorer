<Page
    x:Class="Explorer.MainPage"
    xmlns:entities="using:Explorer.Entities"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:controls="using:Microsoft.Toolkit.Uwp.UI.Controls"
    xmlns:my="using:Explorer.Controls"
    xmlns:models="using:Explorer.Models"
    mc:Ignorable="d" >
    <Page.Resources>
    </Page.Resources>
    <NavigationView MenuItemsSource="{x:Bind ViewModel.NavigationItems}" Background="{ThemeResource SystemControlAcrylicWindowBrush}"
                    IsBackButtonVisible="Collapsed" IsBackEnabled="False"
                    ItemInvoked="{x:Bind ViewModel.NavigateNavigationFSE}">
        <Grid Background="{ThemeResource SystemAltMediumColor }">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>
            <Grid.RowDefinitions>
                <RowDefinition Height="30"/> <!--Spacer for title bar-->
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
            </Grid.RowDefinitions>

            <Grid Grid.Row="1">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>
                
                <Button Grid.Column="0" Command="{x:Bind Path=ViewModel.NavigateBack}">
                    <SymbolIcon Symbol="Back" Margin="10"></SymbolIcon>
                </Button>
                <Button Grid.Column="1" Command="{x:Bind Path=ViewModel.NavigateForward}">
                    <SymbolIcon Symbol="Forward" Margin="10"></SymbolIcon>
                </Button>
                <TextBox Grid.Column="2" Name="TextBoxPath" FontSize="30px" Text="{x:Bind Mode=OneWay, Path=ViewModel.Path }"></TextBox>
                <Button Grid.Column="3">
                    <Button.Flyout>
                        <MenuFlyout Placement="Bottom">
                            <MenuFlyoutItem Text="Open in Powershell" Click="OpenPowershell_Clicked">
                                <MenuFlyoutItem.Icon>
                                    <FontIcon Glyph="&#xE756;"/>
                                </MenuFlyoutItem.Icon>
                            </MenuFlyoutItem>
                            <MenuFlyoutItem Text="Properties">
                                <MenuFlyoutItem.Icon>
                                    <FontIcon Glyph="&#xE946;"/>
                                </MenuFlyoutItem.Icon>
                            </MenuFlyoutItem>
                        </MenuFlyout>
                    </Button.Flyout>
                    <SymbolIcon Symbol="More" Margin="10"></SymbolIcon>
                </Button>
            </Grid>
            
            <!--<ListView Grid.Row="2" ItemsSource="{x:Bind ViewModel.FileSystemElements}"
                      IsItemClickEnabled="True"
                      IsSwipeEnabled="true"
                      SelectionMode="Single">
                <ListView.ItemTemplate>
                    <DataTemplate>
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="300*"/>
                                <ColumnDefinition Width="300*"/>
                                <ColumnDefinition Width="200"/>
                                <ColumnDefinition Width="100"/>
                            </Grid.ColumnDefinitions>

                            <TextBlock Grid.Column="0" Text="{Binding Name}"/>
                            <TextBlock Grid.Column="1" Text="{Binding DateModifiedString}"/>
                            <TextBlock Grid.Column="2" Text="{Binding Type}"/>
                            <TextBlock Grid.Column="3" Text="{Binding Size}"/>
                        </Grid>
                    </DataTemplate>
                </ListView.ItemTemplate>
            </ListView>-->

            <my:TableView Grid.Row="2" 
                          ItemsSource="{x:Bind Path=ViewModel.FileSystemElements, Mode=TwoWay}"
                          ItemDoubleClicked="{x:Bind ViewModel.NavigateNextFSE}">
                <my:TableView.ItemFlyout>
                    <MenuFlyout>
                        <MenuFlyoutItem Text="Open" Icon="OpenFile"></MenuFlyoutItem>
                        <MenuFlyoutItem Text="Open with" Icon="OpenWith"></MenuFlyoutItem>
                        <MenuFlyoutItem Text="Share" Icon="Share"></MenuFlyoutItem>
                        <MenuFlyoutSeparator/>
                        <MenuFlyoutItem Text="Rename" Icon="Edit"></MenuFlyoutItem>
                        <MenuFlyoutItem Text="Delete" Icon="Delete"></MenuFlyoutItem>
                        <MenuFlyoutSeparator/>
                        <MenuFlyoutItem Text="Properties">
                            <MenuFlyoutItem.Icon>
                                <FontIcon Glyph="&#xE946;"/>
                            </MenuFlyoutItem.Icon>
                        </MenuFlyoutItem>
                    </MenuFlyout>
                </my:TableView.ItemFlyout>
            </my:TableView>
        </Grid>
    </NavigationView>
</Page>
